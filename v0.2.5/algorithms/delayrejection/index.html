<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Delay Rejection Method Algorithm · DelaySSAToolkit.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://palmtree2013.github.io/DelaySSAToolkit.jl/algorithms/delayrejection/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DelaySSAToolkit.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/tutorials/">Tutorials</a></li><li><a class="tocitem" href="../../tutorials/bursty/">A bursty model with delay</a></li><li><a class="tocitem" href="../../tutorials/delay_degradation/">A birth-death example with delay degradation</a></li><li><a class="tocitem" href="../../tutorials/heterogeneous_delay/">A birth-death model with heterogeneous fixed delays</a></li><li><a class="tocitem" href="../../tutorials/delay_oscillator/">An auto-regulatory model of oscillatory gene expression</a></li><li><a class="tocitem" href="../../tutorials/stochastic_delay/">A telegraph model of stochastic delay</a></li></ul></li><li><span class="tocitem">Algorithm</span><ul><li><a class="tocitem" href="../notations/">Notations and Basic Concepts</a></li><li class="is-active"><a class="tocitem" href>Delay Rejection Method Algorithm</a><ul class="internal"><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../delaydirect/">Delay Direct Method Algorithm</a></li><li><a class="tocitem" href="../delaymnrm/">Delay Modified Next Reaction Method Algorithm</a></li></ul></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Algorithm</a></li><li class="is-active"><a href>Delay Rejection Method Algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Delay Rejection Method Algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/palmtree2013/DelaySSAToolkit.jl/blob/main/docs/src/algorithms/delayrejection.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Delay-Rejection-Method-Algorithm"><a class="docs-heading-anchor" href="#Delay-Rejection-Method-Algorithm">Delay Rejection Method Algorithm</a><a id="Delay-Rejection-Method-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Delay-Rejection-Method-Algorithm" title="Permalink"></a></h1><p>Simulation methods for systems with delays need to calculate when reactions initiate and store when they complete. However, because of the delayed reactions, the propensity functions can change between initiation times. Bratsun et al. [1] and Barrio et al. [2] used an algorithm for computing the initiation times that is exactly like the original Gillespie Algorithm except that if there is a stored delayed reaction set to finish within a computed time step, then the computed time step is discarded, and the system is updated to incorporate the stored delayed reaction. The algorithm then attempts another step starting at its new state. This algorithm is called the Rejection Method.</p><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><ol><li>Initialize. Set the initial number of molecules of each species and set <span>$t = 0$</span>.</li><li>Calculate the propensity function, <span>$a_k$</span>, for each reaction.</li><li>Set <span>$a_0 = \sum_{k=1}^M a_k$</span>.</li><li>Generate an independent uniform <span>$(0,1)$</span> random number, <span>$r_1$</span>, and set <span>$\Delta = 1/a_0 \ln(1/r_1)$</span>.</li><li>If there is a delayed reaction set to finish in <span>$[t, t + \Delta)$</span><ul><li>Discard <span>$\Delta$</span>.</li><li>Update <span>$t$</span> to be the time of the next delayed reaction,<span>$\mu$</span>.</li><li>Update <span>$\mathbf{x}$</span> according to the stored reaction <span>$\mu$</span>.</li></ul></li><li>Else<ul><li>Generate an independent uniform <span>$(0,1)$</span> random number <span>$r_2$</span>.</li><li>Find <span>$\mu\in[1,\ldots, m]$</span> such that</li></ul><p class="math-container">\[\sum_{k=1}^{\mu-1} a_k(t) &lt; r_2 a_0 \leq \sum_{k=1}^\mu a_k(t)\]</p><ul><li>If <span>$\mu\in \text{ND}$</span>, update the number of each molecular species according to reaction <span>$\mu$</span>.</li><li>If <span>$\mu\in \text{CD}$</span>, store the information that at time <span>$t+\tau_\mu$</span> the system must be updated according to reaction <span>$\mu$</span>.</li><li>If <span>$\mu\in \text{ICD}$</span>, update the system according to the initiation of <span>$\mu$</span> and store that at time <span>$t+\tau_\mu$</span> the system must be updated according to the completion of reaction <span>$\mu$</span>.</li><li>Set <span>$t = t +\Delta$</span></li></ul></li><li>Endif</li><li>Return to step 2 or quit.</li></ol><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Dmitri A. Bratsun, Dmitri N. Volfson, Jeff Hasty, and Lev S. Tsimring &quot;Non-Markovian processes in gene regulation (Keynote Address)&quot;, Proc. SPIE 5845, Noise in Complex Systems and Stochastic Dynamics III, (23 May 2005). <a href="https://www.spiedigitallibrary.org/conference-proceedings-of-spie/5845/1/Non-Markovian-processes-in-gene-regulation/10.1117/12.609707.full">https://doi.org/10.1117/12.609707</a></p><p>[2]  Manuel Barrio, Kevin Burrage, André Leier, Tianhai Tian. &quot;Oscillatory Regulation of Hes1: Discrete Stochastic Delay Modelling and Simulation&quot;, PLoS Computational Biology, 10.1371(2006). <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.0020117">https://doi.org/10.1371/journal.pcbi.0020117</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../notations/">« Notations and Basic Concepts</a><a class="docs-footer-nextpage" href="../delaydirect/">Delay Direct Method Algorithm »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 16 March 2023 12:04">Thursday 16 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
